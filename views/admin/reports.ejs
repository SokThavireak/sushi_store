<div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-6 flex flex-col md:flex-row justify-between items-center gap-4">
    <div>
        <h2 class="text-xl font-bold text-gray-800">Daily Sales Report</h2>
        <div class="flex gap-2 text-xs text-gray-500 mt-1">
            <span>Date: <b class="text-indigo-600"><%= selectedDate %></b></span>
            <span>|</span>
            <span>Store: <b class="text-indigo-600"><%= currentFilter %></b></span>
        </div>
    </div>
    
    <form action="/admin/reports" method="GET" class="flex flex-wrap items-center gap-3 bg-gray-50 p-2 rounded-lg border border-gray-200">
        
        <div class="flex items-center gap-2">
            <label class="text-xs font-bold text-gray-600 uppercase">Date:</label>
            <input type="date" name="date" value="<%= selectedDate %>" 
               onchange="this.form.submit()"
               class="bg-white border border-gray-300 text-sm rounded-md p-1.5 focus:ring-indigo-500 focus:border-indigo-500">
        </div>

        <div class="w-px h-6 bg-gray-300 mx-1"></div>

        <div class="flex items-center gap-2">
            <label class="text-xs font-bold text-gray-600 uppercase">Location:</label>
            
            <% if (user.role === 'store_manager') { %>
                <input type="hidden" name="location" value="<%= currentFilter %>">
                <span class="text-sm font-bold text-gray-800 bg-white px-2 py-1 rounded border"><%= currentFilter %></span>
            <% } else { %>
                <select name="location" onchange="this.form.submit()" class="bg-white border border-gray-300 text-sm rounded-md p-1.5 focus:ring-indigo-500 font-bold text-gray-700">
                    <option value="All" <%= currentFilter === 'All' ? 'selected' : '' %>>All Locations</option>
                    <% locations.forEach(loc => { %>
                        <option value="<%= loc.name %>" <%= currentFilter === loc.name ? 'selected' : '' %>>
                            <%= loc.name %>
                        </option>
                    <% }) %>
                </select>
            <% } %>
        </div>

        <a href="/admin/reports" class="ml-2 text-xs font-bold text-gray-400 hover:text-red-500">
            <i class="fa-solid fa-rotate-left"></i> Reset
        </a>
    </form>
</div>

<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
        <p class="text-xs text-gray-500 uppercase font-semibold">Gross Sales</p>
        <h3 class="text-2xl font-bold text-gray-800 mt-1">$<%= stats.grossSales %></h3>
    </div>
    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
        <p class="text-xs text-gray-500 uppercase font-semibold">Net Profit (Est.)</p>
        <h3 class="text-2xl font-bold text-green-600 mt-1">$<%= stats.netProfit %></h3>
    </div>
    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
        <p class="text-xs text-gray-500 uppercase font-semibold">Total Tx</p>
        <h3 class="text-2xl font-bold text-blue-600 mt-1"><%= stats.totalTx %></h3>
    </div>
    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
        <p class="text-xs text-gray-500 uppercase font-semibold">Avg Order Value</p>
        <h3 class="text-2xl font-bold text-indigo-600 mt-1">$<%= stats.avgOrderValue %></h3>
    </div>
</div>

<div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-100">
        <h3 class="font-bold text-gray-800">Transaction History</h3>
    </div>
    <div class="overflow-x-auto">
        <table class="w-full text-left text-sm">
            <thead class="bg-gray-50 text-gray-500 uppercase text-xs">
                <tr>
                    <th class="px-6 py-3">Order ID</th>
                    <th class="px-6 py-3">Time</th>
                    <th class="px-6 py-3">Location</th> <th class="px-6 py-3">User</th>
                    <th class="px-6 py-3">Payment</th>
                    <th class="px-6 py-3 text-right">Amount</th>
                    <th class="px-6 py-3 text-center">Status</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                <% if (orders.length > 0) { %>
                    <% orders.forEach(order => { %>
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 font-medium text-indigo-600">#<%= order.id %></td>
                        <td class="px-6 py-4 text-gray-600">
                            <%= new Date(order.created_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %>
                        </td>
                        <td class="px-6 py-4 font-bold text-gray-700"><%= order.pickup_location %></td>
                        <td class="px-6 py-4 text-gray-800"><%= order.email || 'Guest/Staff' %></td>
                        <td class="px-6 py-4"><%= order.payment_method %></td>
                        <td class="px-6 py-4 text-right font-bold">$<%= order.total_price %></td>
                        <td class="px-6 py-4 text-center">
                            <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs font-bold"><%= order.status %></span>
                        </td>
                    </tr>
                    <% }) %>
                <% } else { %>
                    <tr><td colspan="7" class="px-6 py-8 text-center text-gray-400">No data found.</td></tr>
                <% } %>
            </tbody>
        </table>
    </div>
</div>